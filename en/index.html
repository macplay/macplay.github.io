<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Share something interesting about byte ocean">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Nikola (getnikola.com)">
<title>MacPlay</title>
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<link href="../assets/css/semantic.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/jquery.fancybox.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="canonical" href="https://macplay.github.io/en/">
<link rel="stylesheet" href="../assets/css/katex.min.css">
</head>
<body>
        <div class="ui grid">
            <div class="computer only three wide column no-print">
                <div id="left-side">
                </div>
            </div>
            <div class="ten wide computer sixteen wide tablet sixteen wide mobile column">
                        <div class="ui inline cookie nag no-print">
            <span class="title">从现在开始，支持中英双语及博文精选 O(∩_∩)O~~</span>
            <i class="close icon"></i>
        </div>
    <header id="header" class="no-print"><div class="ui grid">
        <div class="computer only tablet only sixteen wide column">
            <div class="ui large secondary stackable menu">
                <a class="header item brand-logo" href="https://macplay.github.io/en/">
                    MacPlay
                </a>
                        <a class="item" href="../">Posts</a>
                        <a class="item" href="../listings/">Code</a>
                        <a class="item" href="../galleries/">Gallery</a>
                        <a class="item" href="../categories/">Tags</a>
                        <a class="item" href="../archive.html">Archive</a>
                <div class="right menu">
                    <a class="item" href="../rss.xml"><i class="rss icon"></i>RSS</a>
                </div>
            </div>
        </div>
        <div class="mobile only sixteen wide column">
            <div class="ui fluid accordion vertical menu">
                <div class="item">
                    <a class="title">MacPlay</a>
                    <div class="content">
                                <a class="item" href="../">Posts</a>
                                <a class="item" href="../listings/">Code</a>
                                <a class="item" href="../galleries/">Gallery</a>
                                <a class="item" href="../categories/">Tags</a>
                                <a class="item" href="../archive.html">Archive</a>
                        <a class="item" href="../rss.xml"><i class="rss icon"></i>RSS</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </header><main id="main"><div id="main-content">
    <div class="postindex page-body">
        <div class="index-featured">
        <div class="ui stackable grid">
                <div class="eight wide column">
                    <div class="ui blurring segment">
                        <p>Vim 支持标准的 撤销和重做 ，同时还支持 undo branches 。这允许你撤销一些更改，然后再做新的更改，而在此过程中 所有 的更改都在 undo tree 中得到保留。你甚至还能把撤销（undo）记录保存到文件中，下次编辑同一文件时恢复这些记录。本文将向你初步展示如何在 Vim 中使用 undo branches 。</p>
                    <div class="ui active dimmer">
                        <div class="content">
                            <h2 class="ui inverted header"><a href="posts/zai-vim-zhong-shi-yong-undo-branches/">【译】在 Vim 中使用 undo branches</a></h2>
                        </div>
                    </div>
                    </div>
                </div>
                <div class="eight wide column">
                    <div class="ui blurring segment">
                        <p>本文是《从 Markdown 到 reStructuredText》系列文章的第三篇。和 Markdown 一样，reStructuredText 也是一种易读易写的纯文本标记语言，不过功能上更加强大（而且标准统一）。如果想了解其对应于 Markdown 的基本语法，请阅读 第一篇文章 。本文继续 上一篇文章 的话题，聊一聊标记语言的样式问题，确切的说是 reStructuredText 在静态博客 Nikola...</p>
                        <div class="ui active dimmer">
                            <div class="content">
                                <h2 class="ui inverted header"><a href="posts/cong-markdown-dao-restructuredtextsan/">从 Markdown 到 reStructuredText（三）</a></h2>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
    </div>

    <div class="post-entry post-text">
        <div class="entry-title">
            <a href="posts/ffmpeg-filtering-guide/">FFmpeg Filtering Guide</a>
        </div>
        <div class="ui large horizontal link list post-meta">
            <span class="item">By
                <a href="authors/ashfinal/">ashfinal</a>
            </span>
            <span class="item">
                <time datetime="2020-02-24T20:50:03+08:00">
                2020-02-24 20:50
                </time></span>
            <span class="item">9 MIN READ</span>
        </div>
        <div class="post-summary">
                <div>
<div class="figure align-center">
<a class="reference external image-reference" href="../images/ffmpeg_datascope.png"><img alt="ffmpeg_datascope" src="../images/ffmpeg_datascope.thumbnail.png"></a>
</div>
<div class="contents topic" id="id1">
<p class="topic-title">文档目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="posts/ffmpeg-filtering-guide/#ffmpeg-filtering" id="id12">FFmpeg Filtering 介绍</a></p></li>
<li><p><a class="reference internal" href="posts/ffmpeg-filtering-guide/#testsrc" id="id13">testsrc</a></p></li>
<li><p><a class="reference internal" href="posts/ffmpeg-filtering-guide/#ffmpeg-ffplay-filters" id="id14">在 ffmpeg/ffplay 中使用 filters</a></p></li>
<li><p><a class="reference internal" href="posts/ffmpeg-filtering-guide/#mpv-player" id="id15">mpv player</a></p></li>
<li><p><a class="reference internal" href="posts/ffmpeg-filtering-guide/#mmate" id="id16">mmate</a></p></li>
</ul>
</div>
<div class="section" id="ffmpeg-filtering">
<h2><a class="toc-backref" href="posts/ffmpeg-filtering-guide/#id12">FFmpeg Filtering 介绍</a></h2>
<p>Filtering in FFmpeg is enabled through the libavfilter library.</p>
<p>In libavfilter, a filter can have multiple inputs and multiple outputs. To illustrate the sorts of things that are possible, we consider the following filtergraph:</p>
<pre class="literal-block">                [main]
input --&gt; split ---------------------&gt; overlay --&gt; output
            |                             ^
            |[tmp]                  [flip]|
            +-----&gt; crop --&gt; vflip -------+</pre>
<p>This filtergraph splits the input stream in two streams, then sends one stream through the crop filter and the vflip filter, before merging it back with the other stream by overlaying it on top. You can use the following command to achieve this:</p>
<p class="more"><a href="posts/ffmpeg-filtering-guide/">Read more…</a></p>
</div>
</div>
        </div>
    </div>
    <div class="post-entry post-text">
        <div class="entry-title">
            <a href="posts/the-power-of-diff/">The power of diff</a>
        </div>
        <div class="ui large horizontal link list post-meta">
            <span class="item">By
                <a href="authors/ashfinal/">ashfinal</a>
            </span>
            <span class="item">
                <time datetime="2019-11-14T22:28:48+08:00">
                2019-11-14 22:28
                </time></span>
            <span class="item">3 MIN READ</span>
        </div>
        <div class="post-summary">
                <div>
<p>Lots of people use vimdiff to understand and handle diffs in console mode. While there exist more specialized tools for comparing files, vimdiff has always worked well enough for me.</p>
<div class="section" id="the-inefficiency-of-the-external-diff">
<h2>The inefficiency of the external diff</h2>
<p>However, Vim’s diff mode was seriously lacking. This was basically because it needed to write down temporary files, shell out and run a manual diff command and parse the result back and as one can imagine, this could be slow and was seriously inefficient.</p>
<p>Additionally, this required to have a diff binary available that was able to create <a class="reference external" href="https://en.wikipedia.org/wiki/Diff#Edit_script">ed like style diff</a>, so one could not even fall-back to using git-diff (which is considered to have one of the best tested diff libraries and allows to select different algorithms) for creating those diffs. This lead to the creation of vimscript <a class="reference external" href="https://github.com/chrisbra/vim-diff-enhanced">plugins</a>, that would internally translate a unified diff back into an ed-like diff. Of course this would add an extra performance penalty.</p>
<p class="more"><a href="posts/the-power-of-diff/">Read more…</a></p>
</div>
</div>
        </div>
    </div>
    <div class="post-entry post-text">
        <div class="entry-title">
            <a href="posts/atoms-new-concurrency-friendly-buffer-implementation/">【译】Atom 新的并发友好型 buffer 实现</a>
        </div>
        <div class="ui large horizontal link list post-meta">
            <span class="item">By
                <a href="authors/ashfinal/">ashfinal</a>
            </span>
            <span class="item">
                <time datetime="2019-10-26T14:41:03+08:00">
                2019-10-26 14:41
                </time></span>
            <span class="item">5 MIN READ</span>
        </div>
        <div class="post-summary">
                <div>
<p>Atom 的一些功能依赖于缓冲区（buffer）内容基础上的运算（可能会花费很长时间），但是直到最近，还只能从运行在主线程上的 JavaScript 访问缓冲区的文本。这使得无法在所有情况下保证 Atom 的响应能力，尤其是在编辑较大文件时。</p>
<p>这种情况随着 Atom 1.19 的发布而有所改变，该版本通过使用 C++ 实现的文本存储极大地提高了并行处理能力。这项新设计为性能和可伸缩性提供了诸多好处，其中主要优点之一是 worker 线程可以读取之前缓冲区的快照（snapshot），而不会阻塞主线程上的写入。在这篇文章中，我们将深入介绍 Atom 的文本存储新方法，然后探讨由此带来的首批优化。</p>
<div class="contents topic" id="id1">
<p class="topic-title">文档目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#layering" id="id12">分层（layering）的变动</a></p></li>
<li>
<p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#patch" id="id13">Patch 的数据结构</a></p>
<ul>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#id2" id="id14">存在的问题</a></p></li>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#id3" id="id15">原生的解决方案</a></p></li>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#splay-trees" id="id16">Splay trees</a></p></li>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#id4" id="id17">为我们的用例增强 splay tree</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#id6" id="id18">一些初始优化</a></p>
<ul>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#unsaved-changes" id="id19">高效备份 unsaved changes</a></p></li>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#id8" id="id20">异步保存</a></p></li>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#id9" id="id21">自动补全时在后台进行子序列匹配</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="posts/atoms-new-concurrency-friendly-buffer-implementation/#id11" id="id22">未来回报</a></p></li>
</ul>
</div>
<p class="more"><a href="posts/atoms-new-concurrency-friendly-buffer-implementation/">Read more…</a></p>
</div>
        </div>
    </div>
    <div class="post-entry post-text">
        <div class="entry-title">
            <a href="posts/text-buffer-reimplementation/">【译】重新实现 Text Buffer</a>
        </div>
        <div class="ui large horizontal link list post-meta">
            <span class="item">By
                <a href="authors/ashfinal/">ashfinal</a>
            </span>
            <span class="item">
                <time datetime="2019-10-24T17:35:29+08:00">
                2019-10-24 17:35
                </time></span>
            <span class="item">6 MIN READ</span>
        </div>
        <div class="post-summary">
                <div>
<p>Visual Studio Code 1.21 发行版包含一个全新的 text buffer（文本缓冲区）实现，无论在速度还是在内存使用方面，该实现都更加出色。在本文中，我想讲一下我们是如何选择/设计数据结构和算法以实现这些提升的。</p>
<div class="contents topic" id="id1">
<p class="topic-title">文档目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#text-buffer" id="id19">之前的 text buffer 数据结构</a></p></li>
<li>
<p><a class="reference internal" href="posts/text-buffer-reimplementation/#id3" id="id20">寻找新的 text buffer 实现</a></p>
<ul>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id4" id="id21">使用 piece table 来避免过多的元数据</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id5" id="id22">使用缓存加速行查找</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id6" id="id23">避免字符串合并陷阱</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id7" id="id24">使用平衡二叉树加速行查找</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id9" id="id25">减少对象分配</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="posts/text-buffer-reimplementation/#piece-tree" id="id26">Piece Tree</a></p>
<ul>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id10" id="id27">准备工作</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id11" id="id28">1. 内存使用</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id12" id="id29">2. 文件打开时间</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id13" id="id30">3. 编辑</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id14" id="id31">4. 读取</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="posts/text-buffer-reimplementation/#id15" id="id32">结论与陷阱</a></p>
<ul>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id16" id="id33">得到的教训</a></p></li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id17" id="id34">为何不用原生代码？</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="posts/text-buffer-reimplementation/#id18" id="id35">未来的工作</a></p></li>
</ul>
</div>
<p class="more"><a href="posts/text-buffer-reimplementation/">Read more…</a></p>
</div>
        </div>
    </div>
    <div class="post-entry post-text">
        <div class="entry-title">
            <a href="posts/run-vim-editor-on-browsers/">在浏览器中运行 Vim 编辑器</a>
        </div>
        <div class="ui large horizontal link list post-meta">
            <span class="item">By
                <a href="authors/ashfinal/">ashfinal</a>
            </span>
            <span class="item">
                <time datetime="2019-10-23T21:29:00+08:00">
                2019-10-23 21:29
                </time></span>
            <span class="item">1 MIN READ</span>
        </div>
        <div class="post-summary">
                <div>
<p>有人将 Vim 编辑器移植到了 WebAssembly (Wasm) 格式： <a class="reference external" href="https://github.com/rhysd/vim.wasm">vim.wasm: Vim Ported to WebAssembly</a> 。 <a class="reference external" href="https://webassembly.org/">Wasm</a> 是一种底层的二进制指令格式，理论上能实现接近 C/C++/Rust 等编译性语言的执行速度，目前已经在主流浏览器 Chrome/Safari/Firefox/Edge 中得到支持。所以现在，你可以在浏览器上体验原汁原味的 Vim 了！</p>
<div class="figure align-center">
<img alt="vim.wasm on chrome" src="../images/chrome_vim_wasm.png">
</div>
<p class="more"><a href="posts/run-vim-editor-on-browsers/">Read more…</a></p>
</div>
        </div>
    </div>
    </div>

        <div class="ui grid page-navigation">
    <div class="computer only tablet only sixteen wide column">
        <div class="ui small borderless secondary pagination menu">
        <a class="disabled item"><i class="angle left icon"></i></a>
                    <a class="active item" href=".">1</a>
                    <a class="item" href="index-1.html">2</a>
                    <a class="item" href="index-2.html">3</a>
                    <a class="item" href="index-3.html">4</a>
                    <a class="item" href="index-4.html">5</a>
                    <a class="item" href="index-5.html">6</a>
                <a class="item">…</a>
                    <a class="item" href="index-13.html">14</a>
        <a class="item" href="index-1.html"><i class="angle right icon"></i></a>
        </div>
    </div>
    <div class="mobile only sixteen wide column">
        <div class="pager">
        <button class="ui basic right floated button">
        <a href="index-1.html">Older posts</a>
        </button>
        </div>
    </div>
</div>

                    </div>
                </main><div class="footer extra-block no-print">
    <span class="footer_item">
        <a href="../pages/you-qing-lian-jie/">友情链接</a>
    </span>
    <span class="footer_item">
        <a href="../pages/liu-yan-ban/">留言板</a>
    </span>
    <span class="footer_item">
        <a href="../pages/ge-ren-dong-tai/">碎碎念</a>
    </span>
    </div>
            <div class="footer social-link no-print">
            <a href="https://github.com/ashfinal" target="_blank"><i class="grey large github icon"></i></a>
            <a href="http://weibo.com/ashfinal/" target="_blank"><i class="grey large weibo icon"></i></a>
            <a href="mailto://ashfinal@sina.cn" target="_blank"><i class="grey large mail icon"></i></a>
            </div>
        <div class="ui basic center aligned segment no-print">Contents © 2020         <a href="mailto:ashfinal@sina.cn">ashfinal</a> - Powered by         <a href="https://getnikola.com" target="_blank" rel="nofollow">Nikola</a>         </div>

            </div>
            <div class="computer only three wide column no-print">
                <div id="right-side">
                </div>
            </div>
        </div>

        <!-- GoStats JavaScript Based Code -->
        <script type="text/javascript">(function(c,o,m,p,u,t,e){
        c['GoStatsObject']=u;c[u]=c[u]||function(){(c[u].q=c[u].q||[]).push(arguments)},
        c[u].l=1*new Date();t=o.createElement(m);t.async=1;t.src=p;
        e=o.getElementsByTagName(m)[0];e.parentNode.insertBefore(t,e);
        })(window,document,'script','//www.gostats.org/5.js','go');
        go('init',100479892,{'img_counter_type':5,'img_image_type':1});go('send');</script><!-- End GoStats JavaScript Based Code --><script type="text/javascript" src="../assets/js/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../assets/js/semantic.min.js"></script><script type="text/javascript" src="../assets/js/jquery.fancybox.min.js"></script><script type="text/javascript" src="../assets/js/cookie.min.js"></script><script>
            $(document).ready(function(){
                $(".ui.dropdown").dropdown();
                $('.ui.accordion').accordion();
                var newstr = $('.cookie.nag').text();
                $('.cookie.nag').nag({
                    key: 'globalnotice',
                    value: newstr
                  });
                $('.image-reference').fancybox();
            });
        </script><script src="../assets/js/katex.min.js"></script><script src="../assets/js/auto-render.min.js"></script><script>
                renderMathInElement(document.body,
                    {
                        delimiters: [
                            {left: "$$", right: "$$", display: true},
                            {left: "\\[", right: "\\]", display: true},
                            {left: "\\begin{equation*}", right: "\\end{equation*}", display: true},
                            {left: "\\(", right: "\\)", display: false}
                        ]
                    }
                );
            </script>
</body>
</html>
